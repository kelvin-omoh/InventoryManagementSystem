(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[157],{4353:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/inventory",function(){return t(8348)}])},8348:function(e,s,t){"use strict";t.r(s);var l=t(5893),a=t(6375),r=t(9446);t(4125),t(7804);var c=t(9008),n=t.n(c),i=t(1804),o=t(3750),d=t(9377),x=t(6100),h=t(7294),u=t(9583),p=t(381),m=t.n(p);t(9669);var f=t(8079);t(1019),t(2920);var g=t(2619);let j=()=>{let{Admin:e,setAdmin:s,setName:t,name:c}=(0,h.useContext)(g.Z),[d,p]=(0,h.useState)([]),[j,y]=(0,h.useState)(0),[v,N]=(0,h.useState)(0),[b,w]=(0,h.useState)(0),[k,E]=(0,h.useState)(0),[S,P]=(0,h.useState)(0),[C,D]=(0,h.useState)(""),_=new Date;_.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),(0,h.useEffect)(()=>{let e=(0,x.hJ)(f.db,"inventory"),s=async()=>{let s=await (0,x.PL)(e),t=[];null==s||s.forEach(e=>{null==t||t.push({...e.data(),id:e.id})}),p(t||[]),y(t.length)};s();let t=(0,x.cf)(e,e=>{let s=[];e.forEach(e=>{s.push({...e.data(),id:e.id})}),p(s),y(s.length)});return()=>{t()}},[]);let[A,T]=(0,h.useState)(0);(0,h.useEffect)(()=>{console.log("Effect triggered!")},[A]);let z=e=>{},B=async e=>{await (0,x.oe)((0,x.JU)(f.db,"inventory",e))},L=d.filter(e=>e.productName.toLowerCase().includes(C.toLowerCase())),X=async(e,s,t,l)=>{console.log(4);let a={ProductDate:e,ProductName:s,Productmessage:t,ProductMetaData:l};await fetch("http://localhost:3001/send-sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(e=>{console.log(a)}).catch(e=>{console.error(e)})};return(0,h.useEffect)(()=>{let e=0,s=0,t=0;d.forEach(l=>{m()(null==l?void 0:l.day).isBefore(m()())&&(e++,console.log(l.day),e>0&&(console.log(e),console.log(0x18abef7846071c0),console.log(l.day,l.productName))),l.quantity<=190&&s++,l.quantity>=200&&t++}),w(e),E(s),P(t)},[b]),(0,h.useEffect)(()=>{let e=0;d.forEach(s=>{m()(null==s?void 0:s.day).isBefore(m()())&&(w(++e),console.log(e),e>0&&(console.log(e),console.log(0x18abef7846071c0),X(s.day,s.productName,"(Your Product has expired) "," has expired on the "),console.log(s.day,s.productName,"(Your Product has expired) "," has expired on the ")))})},[d]),(0,h.useEffect)(()=>{d.forEach(e=>{console.log(e.day);let s=e.day,t=new Date(s),l=new Date,a=new Date(t);a.setDate(a.getDate());let r=new Date(t);r.setDate(r.getDate()-2),console.log(a,"Alert time 1"),console.log(l,"current time"),console.log(r,"timeUntilAlert1"),a>l&&(console.log("Sending first alert"),console.log("MESAGE SENT:   "+e.day,e.productName,"(2 days before expiration) "," is expiring on the ")),r>l&&(console.log("Sending second alert"),console.log("MESAGE SENT:   "+e.day,e.productName,"(4 days before expiration) "," is expiring on the "))})},[d]),(0,l.jsxs)("div",{children:[(0,l.jsxs)(n(),{children:[(0,l.jsx)("title",{children:"Create Next App"}),(0,l.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,l.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,l.jsx)(i.Z,{children:(0,l.jsxs)("main",{className:"px-3 bg-gray-100 h-[150vh] ",children:[(0,l.jsx)(a.Z,{}),(0,l.jsx)(r.Z,{}),(0,l.jsxs)("div",{className:"p-4 w-full grid gap-2",children:[(0,l.jsx)("h1",{className:" text-[#010D82] font-semibold",children:"Inventory "}),(0,l.jsxs)("div",{className:"flex flex-row justify-between gap-4",children:[(0,l.jsxs)("div",{className:"overflow-x-auto sm:mx-0.5 lg:mx-0.5 w-full bg-indigo-500 p-3 rounded-md text-white",children:[(0,l.jsx)(o.G3K,{size:30}),(0,l.jsxs)("div",{className:" flex justify-between w-full mt-[4em]",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:"All Product"}),(0,l.jsx)("p",{children:d.length})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{children:"Active"}),(0,l.jsx)("p",{children:S})]})]})]}),(0,l.jsxs)("div",{className:"overflow-x-auto sm:mx-0.5 lg:mx-0.5 w-full bg-black/5 p-3 rounded-md text-black",children:[(0,l.jsx)(o.w7k,{size:30}),(0,l.jsxs)("div",{className:" flex justify-between w-full mt-[4em]",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h5",{className:" text-red-700 font-thin",children:"Low Stock Alert"}),(0,l.jsx)("p",{children:k})]}),(0,l.jsxs)("div",{className:" text-center",children:[(0,l.jsxs)("h5",{className:" flex justify-center items-center gap-2",children:["Expired   ",(0,l.jsx)(u.a4m,{})]}),(0,l.jsx)("p",{children:b})]})]})]})]})]}),(0,l.jsxs)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg mx-5",children:[(0,l.jsxs)("div",{className:"pb-4 bg-white w-[87vw] dark:bg-gray-900",children:[(0,l.jsx)("label",{for:"table-search",className:"sr-only",children:"Search"}),(0,l.jsxs)("div",{className:"relative mt-1 w-full",children:[(0,l.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-gray-500 dark:text-gray-400","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})})}),(0,l.jsx)("input",{type:"text",id:"table-search",className:"block p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Search for items",value:C,onChange:e=>D(e.target.value)})]})]}),(0,l.jsxs)("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[(0,l.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:["S/N",(0,l.jsx)("label",{for:"checkbox-all-search",className:"sr-only",children:"checkbox"})]})}),(0,l.jsx)("th",{scope:"col",className:" py-3 w-[3em] max-w-[2em]",children:"Product name"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3",children:(0,l.jsxs)("div",{className:"px-6 w-fit h-fit py-3 flex gap-3 justify-center items-center",children:["Category ",(0,l.jsx)(u.$nz,{})]})}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3",children:"Unit Price ₦"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3",children:(0,l.jsxs)("div",{className:"px-6 w-fit h-fit py-3 flex gap-3 justify-center items-center",children:["In Stock ",(0,l.jsx)(u.FeP,{})]})}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3",children:(0,l.jsxs)("div",{className:"px-6 w-fit h-fit py-3 flex gap-3 justify-center items-center",children:["Expiring date ",(0,l.jsx)(u.j5f,{})]})}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3",children:(0,l.jsx)("div",{className:"px-6 w-fit h-fit py-3 flex gap-3 justify-center items-center",children:"Total Price ₦"})}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3"})]})}),(0,l.jsx)("tbody",{className:"",children:null==L?void 0:L.map((s,t)=>(0,l.jsxs)("tr",{className:"bg-white border-b text-center h-fit dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,l.jsx)("td",{className:"w-4 p-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:[t+1,(0,l.jsx)("label",{for:"checkbox-table-search-1",className:"sr-only",children:"checkbox"})]})}),(0,l.jsx)("th",{scope:"row",className:"px-6 break-keep break-words w-[12px] py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:null==s?void 0:s.productName}),(0,l.jsx)("td",{className:"px-6 py-4",children:null==s?void 0:s.categories}),(0,l.jsxs)("td",{className:"px-6 py-4",children:["₦ ",null==s?void 0:s.costPrice]}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("a",{href:"#",className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:[null==s?void 0:s.quantity," X"]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("a",{href:"#",className:"font-medium text-blue-600 dark:text-blue-500 hover:underline ".concat(m()(null==s?void 0:s.day).isBefore(m()())&&" text-red-500 "),children:[null==s?void 0:s.day,m()(null==s?void 0:s.day).isBefore(m()())&&(0,l.jsx)("div",{children:" EXPIRED"})]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("a",{href:"#",className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:["₦ ",(null==s?void 0:s.sellingPrice)*(null==s?void 0:s.quantity)]})}),e?(0,l.jsx)("td",{onClick:()=>z(s),className:" mx-3 rounded relative flex gap-4 cursor-pointer ",children:(0,l.jsxs)("div",{onClick:()=>B(s.id),className:" px-6 py-4 rounded-lg flex justify-center items-center cursor-pointer text-white bg-red-500 hover:bg-red-600 gap-2",children:["Delete",(0,l.jsx)(u.Xm5,{className:" "})]})}):null]},t))})]})]})]})})]})};s.default=(0,d.default)(j)},9377:function(e,s,t){"use strict";t.r(s);var l=t(5893),a=t(7294),r=t(1163),c=t(8079);let n=e=>s=>{let t=(0,r.useRouter)();return(0,a.useEffect)(()=>{let e=c.I8.onAuthStateChanged(e=>{console.log(e),e||t.push("/signin")});return()=>e()},[]),(0,l.jsx)(e,{...s})};s.default=n}},function(e){e.O(0,[196,885,627,199,370,320,774,888,179],function(){return e(e.s=4353)}),_N_E=e.O()}]);